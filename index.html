<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Dentist Appointment ChatBot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts Poppins -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(270deg, #4f46e5, #9333ea, #f59e0b, #10b981);
            background-size: 800% 800%;
            animation: gradientBG 15s ease infinite;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .chat-bubble {
            border-radius: 15px;
            padding: 10px 15px;
            margin: 5px 0;
            max-width: 80%;
            word-wrap: break-word;
        }

        .user-bubble {
            background-color: #4f46e5;
            color: white;
            float: right;
            text-align: right;
        }

        .bot-bubble {
            background-color: #f59e0b;
            color: white;
            float: left;
            text-align: left;
        }

        .chat-container::-webkit-scrollbar {
            width: 6px;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background-color: rgba(0,0,0,0.3);
            border-radius: 3px;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col items-center justify-center p-4">
    <div class="w-full max-w-md bg-white/80 backdrop-blur-md rounded-2xl shadow-lg p-6">
        <h1 class="text-3xl font-bold text-gray-900 text-center mb-4 flex items-center justify-center">
            <img src="https://cdn-icons-png.flaticon.com/512/1995/1995593.png" alt="bot" class="w-10 h-10 mr-2">
            DentistBot
        </h1>

        <div id="conversation" class="chat-container h-96 overflow-y-auto p-3 bg-gray-100 rounded-xl mb-4">
            <!-- Chat messages -->
        </div>

        <form id="chatform" onsubmit="return pushChat();" class="flex gap-2">
            <input type="text" id="wisdom" placeholder="Type your message..." 
                   class="flex-1 rounded-lg p-3 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500">
            <button type="submit" 
                    class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">Send</button>
        </form>
    </div>

    <!-- AWS SDK -->
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1440.0.min.js"></script>

    <script>
        // Config AWS Cognito
        AWS.config.region = 'us-east-1'; // Troque pela regi√£o do seu bot
        AWS.config.credentials = new AWS.CognitoIdentityCredentials({
            IdentityPoolId: 'us-east-1:xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx', // SEU IdentityPoolId
        });

        const lexRuntimeV2 = new AWS.LexRuntimeV2();
        const lexUserId = 'chatbot-demo-' + Date.now();

        // Config Bot
        const BOT_ID = 'xxxxxxxxxx';      // Seu BOT_ID
        const BOT_ALIAS_ID = 'xxxxxxxxx'; // Seu BOT_ALIAS_ID
        const LOCALE_ID = 'en_US';

        function pushChat() {
            const wisdomText = document.getElementById('wisdom');
            const wisdom = wisdomText.value.trim();
            if (!wisdom) return false;

            showMessage(wisdom, 'user');
            wisdomText.value = '';

            lexRuntimeV2.recognizeText({
                botId: BOT_ID,
                botAliasId: BOT_ALIAS_ID,
                localeId: LOCALE_ID,
                sessionId: lexUserId,
                text: wisdom
            }).promise()
              .then(data => {
                  if (data?.messages) {
                      data.messages.forEach(msg => msg.content && showMessage(msg.content, 'bot'));
                  }
              })
              .catch(err => {
                  console.error(err);
                  showMessage('‚ö†Ô∏è Error: ' + err.message, 'bot');
              });

            return false;
        }

        function showMessage(text, sender) {
            const conversation = document.getElementById('conversation');
            const p = document.createElement('div');
            p.className = `chat-bubble ${sender === 'user' ? 'user-bubble ml-auto' : 'bot-bubble mr-auto'}`;
            p.innerText = text;
            conversation.appendChild(p);
            conversation.scrollTop = conversation.scrollHeight;
        }

        // Sauda√ß√£o inicial
        showMessage('üëã Hi! I am DentistBot. How can I help you today?', 'bot');
    </script>
</body>
</html>

